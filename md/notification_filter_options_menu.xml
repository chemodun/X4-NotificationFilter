<?xml version="1.0" encoding="utf-8"?>
<mdscript name="Notification_Filter_Options_Menu" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <cues>
    <cue name="Init" instantiate="false" version="1">
      <actions>
      </actions>
      <cues>
        <cue name="Register_Menu" instantiate="true" version="1">
          <conditions>
            <event_cue_signalled cue="md.Simple_Menu_API.Reloaded" />
          </conditions>
          <actions>
            <debug_text text="'NotificationFilter Options: Registering Options Menus'" context="false" filter="scripts" />
            <include_actions ref="md.Notification_Filter.DefaultFilters" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Register_Options_Menu"
              param="table[
                $id      = 'Notification_Filter_options_menu',
                $columns = 8,
                $title   = {1972092413, 10000},
                $onOpen  = Notification_Filter_Options_Menu,
              ]" />
          </actions>
        </cue>

        <cue name="Notification_Filter_Options_Menu" instantiate="true" version="1">
          <conditions>
            <event_cue_signalled />
          </conditions>
          <actions>
            <debug_text text="'NotificationFilter Options: Opening Notification Filter Menu'" context="false" filter="scripts" />
            <include_actions ref="md.Notification_Filter.DefaultFilters" />
            <debug_text
              text="'NotificationFilter Options: Current filters: %s' . [$filters]"
              context="false" filter="scripts" />
            <set_value name="$debugLevelCurrentIndex" exact="$debugLevelIndexes.indexof.{$commonData.$debugLevel}" />
            <do_if value="$debugLevelCurrentIndex == 0">
              <set_value name="$debugLevelCurrentIndex" exact="1" />
            </do_if>
            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
              param="table[
                $col = 1,
                $colSpan = 8,
                $titleColor = 'Color.text_normal',
                $halign = 'center',
                $text = {1972092413, 10100},
              ]" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
              param="table[
                $col = 1,
                $colSpan = 5,
                $text = {1972092413, 10110},
              ]" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Dropdown"
              param="table[
                $id = 'Notification_Filter_Reputation',
                $col = 6,
                $colSpan = 3,
                $options = [
                  table[ $text = {1972092413, 10111}, $value = 0 ],
                  table[ $text = {1972092413, 10112}, $value = 1 ],
                  table[ $text = {1972092413, 10113}, $value = 2 ],
                  table[ $text = {1972092413, 10114}, $value = 5 ],
                  table[ $text = {1972092413, 10115}, $value = 10 ]
                ],
                $startOption = $filters.$reputation,
                $onDropDownConfirmed = Handle_Dropdown_Changed,
              ]" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
              param="table[
                $col = 1,
                $colSpan = 5,
                $text = {1972092413, 10120},
              ]" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Dropdown"
              param="table[
                $id = 'Notification_Filter_Reputation_Logbook',
                $col = 6,
                $colSpan = 3,
                $options = [
                  table[ $text = {1972092413, 10111}, $value = 0 ],
                  table[ $text = {1972092413, 10112}, $value = 1 ],
                  table[ $text = {1972092413, 10113}, $value = 2 ],
                  table[ $text = {1972092413, 10114}, $value = 5 ],
                  table[ $text = {1972092413, 10115}, $value = 10 ]
                ],
                $startOption = $filters.$reputationLogbook,
                $onDropDownConfirmed = Handle_Dropdown_Changed,
              ]" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
              param="table[
                $col = 1,
                $colSpan = 8,
                $titleColor = 'Color.text_normal',
                $halign = 'center',
                $text = {1972092413, 10200},
              ]" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Text"
              param="table[
                $col = 1,
                $colSpan = 8,
                $halign = 'left',
                $text = {1972092413, 10210},
              ]" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Add_Row" />
            <signal_cue_instantly cue="md.Simple_Menu_API.Make_Slider"
              param="table[
                $id = 'Notification_Filter_Money',
                $col = 1,
                $colSpan = 8,
                $min = 0,
                $max = 100000000,
                $step = 1000,
                $start = $filters.$money,
                $suffix = ' %s.'.[{1001, 101}],
                $onSliderCellConfirm = Handle_Slider_Changed,
              ]" />
            <remove_value name="$filters" />
          </actions>
        </cue>

        <cue name="Handle_Dropdown_Changed" instantiate="true" version="1">
          <conditions>
            <event_cue_signalled />
          </conditions>
          <actions>
            <include_actions ref="md.Notification_Filter.DefaultFilters" />
            <debug_text text="'NotificationFilter Options: Dropdown %s changed to %s. Current filters: %s' .[event.param.$id, event.param.$option.$value, $filters]" context="false" filter="scripts" />
            <set_value name="$id" exact="event.param.$id" />
            <set_value name="$value" exact="event.param.$option.$value" />
            <do_if value="$id == 'Notification_Filter_Reputation'">
              <set_value name="$filters.$reputation" exact="$value" />
            </do_if>
            <do_elseif value="$id == 'Notification_Filter_Reputation_Logbook'">
              <set_value name="$filters.$reputationLogbook" exact="$value" />
            </do_elseif>
            <debug_text text="'NotificationFilter Options: Updated filters: %s' . [$filters]" context="false" filter="scripts" />
            <remove_value name="$id" />
            <remove_value name="$value" />
            <remove_value name="$filters" />
          </actions>
        </cue>

        <cue name="Handle_Slider_Changed" instantiate="true" version="1">
          <conditions>
            <event_cue_signalled />
          </conditions>
          <actions>
            <include_actions ref="md.Notification_Filter.DefaultFilters" />
            <debug_text text="'NotificationFilter Options: Slider %s changed to %s. Current filters: %s' .[event.param.$id, event.param.$value, $filters]" context="false" filter="scripts" />
            <set_value name="$id" exact="event.param.$id" />
            <set_value name="$value" exact="event.param.$value" />
            <do_if value="$id == 'Notification_Filter_Money'">
              <set_value name="$filters.$money" exact="$value" />
            </do_if>
            <debug_text text="'NotificationFilter Options: Updated filters: %s' . [$filters]" context="false" filter="scripts" />
            <remove_value name="$id" />
            <remove_value name="$value" />
            <remove_value name="$filters" />
          </actions>
        </cue>

      </cues>
    </cue>


  </cues>
</mdscript>